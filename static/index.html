<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Karina Admin Panel</title>
    
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js" crossorigin></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ */
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; background-color: #020617;
            color: #ffffff; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            transition: background 0.5s ease;
        }

        /* –§–æ–Ω —Å –ö–∞—Ä–∏–Ω–æ–π - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç */
        .bg-karina {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, rgba(2, 6, 23, 0.4), rgba(2, 6, 23, 0.9)), url('karina.jpg');
            background-size: cover; background-position: center;
            z-index: -1;
            transition: background 0.5s ease;
        }

        /* –ü—É–∑—ã—Ä–∏ */
        .bubble {
            position: absolute; border-radius: 50%;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer; transition: transform 0.2s, border-color 0.3s, box-shadow 0.3s;
            box-shadow: inset 0 4px 15px rgba(255,255,255,0.1), 0 10px 20px rgba(0,0,0,0.3);
            animation: float 12s infinite ease-in-out;
            pointer-events: auto;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0); }
            33% { transform: translateY(-40px) translateX(20px); }
            66% { transform: translateY(-20px) translateX(-20px); }
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ Glassmorphism */
        .glass-card {
            background: rgba(15, 23, 42, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 24px;
            width: 90%; max-width: 400px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .pop-effect { animation: pop 0.3s forwards; }
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); opacity: 0.5; }
            100% { transform: scale(0); opacity: 0; }
        }

        .scroll-hide::-webkit-scrollbar { display: none; }
        .scroll-hide { -ms-overflow-style: none; scrollbar-width: none; }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —ç–º–æ—Ü–∏–∏ */
        .emotion-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 8px 16px;
            border-radius: 20px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            z-index: 100;
            transition: all 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="bg-karina"></div>
    <div id="root"></div>
    <div id="emotion-indicator" class="emotion-indicator" style="display: none;"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        console.log("üöÄ Mini App: –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...");
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        const tg = window.Telegram?.WebApp;
        console.log("üì± Telegram WebApp:", tg ? "–Ω–∞–π–¥–µ–Ω" : "–ù–ï –Ω–∞–π–¥–µ–Ω");
        
        if (tg) {
            console.log("‚ÑπÔ∏è Telegram theme:", tg.themeParams);
            tg.ready();
            tg.expand();
            console.log("‚úÖ Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω");
        } else {
            console.warn("‚ö†Ô∏è –ó–∞–ø—É—Å–∫ –≤–Ω–µ Telegram");
        }

        // –¶–≤–µ—Ç–æ–≤—ã–µ —Ç–µ–º—ã –¥–ª—è —ç–º–æ—Ü–∏–π
        const EMOTION_THEMES = {
            neutral: { primary: "#38bdf8", secondary: "#94a3b8", bg: "linear-gradient(to bottom, rgba(2, 6, 23, 0.4), rgba(2, 6, 23, 0.9))" },
            positive: { primary: "#4ade80", secondary: "#2dd4bf", bg: "linear-gradient(to bottom, rgba(2, 6, 23, 0.4), rgba(20, 83, 45, 0.9))" },
            excited: { primary: "#facc15", secondary: "#fb923c", bg: "linear-gradient(to bottom, rgba(2, 6, 23, 0.4), rgba(113, 63, 18, 0.9))" },
            sad: { primary: "#60a5fa", secondary: "#818cf8", bg: "linear-gradient(to bottom, rgba(2, 6, 23, 0.4), rgba(30, 58, 138, 0.9))" },
            angry: { primary: "#f87171", secondary: "#dc2626", bg: "linear-gradient(to bottom, rgba(2, 6, 23, 0.4), rgba(127, 29, 29, 0.9))" },
            romantic: { primary: "#fb7185", secondary: "#e879f9", bg: "linear-gradient(to bottom, rgba(2, 6, 23, 0.4), rgba(131, 24, 67, 0.9))" },
            work: { primary: "#a78bfa", secondary: "#6366f1", bg: "linear-gradient(to bottom, rgba(2, 6, 23, 0.4), rgba(49, 46, 129, 0.9))" }
        };

        const Bubble = ({ icon, label, onClick, delay, size, top, left, color }) => {
            const [popped, setPopped] = useState(false);
            
            const handleClick = (e) => {
                e.stopPropagation();
                setPopped(true);
                setTimeout(() => {
                    onClick();
                    setPopped(false);
                }, 300);
            };

            return (
                <div 
                    className={`bubble ${popped ? 'pop-effect' : ''}`}
                    style={{ 
                        width: size, height: size, top: top, left: left,
                        animationDelay: delay, borderTop: `2px solid ${color}`
                    }}
                    onClick={handleClick}
                >
                    <i className={`fa-solid ${icon} text-2xl mb-1`} style={{ color: color }}></i>
                    <span className="text-[10px] font-bold uppercase tracking-tighter" style={{ color: color }}>{label}</span>
                </div>
            );
        };

        const App = () => {
            console.log("üé® App: –†–µ–Ω–¥–µ—Ä...");
            
            const [activeTab, setActiveTab] = useState(null);
            const [status, setStatus] = useState({ emoji: '...', health_confirmed: true });
            const [events, setEvents] = useState([]);
            const [search, setSearch] = useState("");
            const [memories, setMemories] = useState("");
            const [emotion, setEmotion] = useState("neutral");
            const [emotionTheme, setEmotionTheme] = useState(EMOTION_THEMES.neutral);
            const [healthStats, setHealthStats] = useState(null);
            const [isLoading, setIsLoading] = useState(true);
            const [error, setError] = useState(null);

            useEffect(() => {
                console.log("üîÑ App: Mount...");
                initApp();
            }, []);

            const initApp = async () => {
                try {
                    console.log("üì° –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...");
                    await fetchData();
                    await fetchEmotion();
                    setIsLoading(false);
                    console.log("‚úÖ App: –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã");
                } catch (err) {
                    console.error("‚ùå App: –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:", err);
                    setError(err.message);
                    setIsLoading(false);
                }
            };

            const fetchData = async () => {
                try {
                    const [resStatus, resCal] = await Promise.all([
                        fetch('/api/status'),
                        fetch('/api/calendar')
                    ]);
                    if (!resStatus.ok || !resCal.ok) {
                        throw new Error(`HTTP error: ${resStatus.status}/${resCal.status}`);
                    }
                    setStatus(await resStatus.json());
                    const calData = await resCal.json();
                    setEvents(calData.events || []);
                } catch (e) { 
                    console.error("Data fetch error", e);
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ—à–∏–±–∫—É
                    alert("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.");
                }
            };

            const fetchEmotion = async () => {
                try {
                    const res = await fetch('/api/emotion');
                    if (!res.ok) {
                        throw new Error(`HTTP error: ${res.status}`);
                    }
                    const data = await res.json();
                    if (data.emotion) {
                        setEmotion(data.emotion);
                        const theme = EMOTION_THEMES[data.emotion] || EMOTION_THEMES.neutral;
                        setEmotionTheme(theme);
                        applyEmotionTheme(theme, data.emotion);
                    }
                } catch (e) { 
                    console.error("Emotion fetch error", e);
                }
            };

            const applyEmotionTheme = (theme, emotionName) => {
                // –ü—Ä–∏–º–µ–Ω—è–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç —Ñ–æ–Ω–∞
                document.querySelector('.bg-karina').style.background = theme.bg;
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
                const indicator = document.getElementById('emotion-indicator');
                if (indicator) {
                    indicator.style.display = 'block';
                    indicator.style.color = theme.primary;
                    indicator.style.borderColor = theme.primary;
                    indicator.textContent = emotionName || emotion;
                }
            };

            const handleSearch = async () => {
                if (!search) return;
                const res = await fetch(`/api/memory/search?q=${encodeURIComponent(search)}`);
                const data = await res.json();
                setMemories(data.results);
            };

            const fetchHealthStats = async () => {
                try {
                    const res = await fetch('/api/health?days=7');
                    const data = await res.json();
                    setHealthStats(data);
                } catch (e) { console.error("Health stats error", e); }
            };

            const fetchEmotionTest = async (emotionName) => {
                try {
                    const res = await fetch('/api/emotion', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ emotion: emotionName })
                    });
                    const data = await res.json();
                    if (data.emotion) {
                        setEmotion(data.emotion);
                        const theme = EMOTION_THEMES[data.emotion] || EMOTION_THEMES.neutral;
                        setEmotionTheme(theme);
                        applyEmotionTheme(theme, data.emotion);
                    }
                } catch (e) { console.error("Emotion test error", e); }
            };
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
            const [isOnline, setIsOnline] = useState(navigator.onLine);
            
            useEffect(() => {
                const handleOnline = () => setIsOnline(true);
                const handleOffline = () => setIsOnline(false);
                window.addEventListener('online', handleOnline);
                window.addEventListener('offline', handleOffline);
                return () => {
                    window.removeEventListener('online', handleOnline);
                    window.removeEventListener('offline', handleOffline);
                };
            }, []);

            return (
                <div className="relative w-full h-full overflow-hidden">
                    {/* –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ */}
                    {isLoading && (
                        <div className="absolute inset-0 z-50 flex items-center justify-center bg-[#020617]">
                            <div className="text-center">
                                <div className="text-6xl mb-4 animate-pulse">ü§ñ</div>
                                <h2 className="text-2xl font-bold text-white mb-2">KARINA</h2>
                                <p className="text-slate-400 text-sm">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                            </div>
                        </div>
                    )}
                    
                    {/* –≠–∫—Ä–∞–Ω –æ—à–∏–±–∫–∏ */}
                    {error && (
                        <div className="absolute inset-0 z-50 flex items-center justify-center bg-[#020617] p-6">
                            <div className="text-center max-w-md">
                                <div className="text-6xl mb-4">‚ùå</div>
                                <h2 className="text-xl font-bold text-white mb-2">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h2>
                                <p className="text-slate-400 text-sm mb-4">{error}</p>
                                <button 
                                    onClick={() => window.location.reload()}
                                    className="bg-sky-500 px-6 py-3 rounded-xl font-bold hover:bg-sky-600 transition"
                                >
                                    –û–±–Ω–æ–≤–∏—Ç—å
                                </button>
                            </div>
                        </div>
                    )}
                    
                    {/* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è */}
                    <div className={`absolute top-2 right-2 z-50 px-3 py-1 rounded-full text-xs font-bold ${isOnline ? 'bg-emerald-500/80 text-white' : 'bg-red-500/80 text-white'}`}>
                        {isOnline ? '‚óè Online' : '‚úï Offline'}
                    </div>

                    {/* –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω */}
                    {!isLoading && !error && (
                        <div className="relative w-full h-full">
                            <header className="absolute top-12 left-0 w-full text-center px-4">
                                <h1 className="text-5xl font-black italic tracking-tighter text-white drop-shadow-2xl">KARINA</h1>
                                <div className="h-1 w-20 bg-sky-500 mx-auto mt-2 rounded-full shadow-[0_0_10px_rgba(56,189,248,0.8)]"></div>
                            </header>

                            <Bubble icon="fa-calendar-check" label="–ü–ª–∞–Ω—ã" size="100px" top="25%" left="10%" delay="0s" color="#38bdf8" onClick={() => setActiveTab('calendar')} />
                            <Bubble icon="fa-brain" label="–ü–∞–º—è—Ç—å" size="110px" top="42%" left="52%" delay="2s" color="#c084fc" onClick={() => setActiveTab('memory')} />
                            <Bubble icon="fa-heart-pulse" label="–°—Ç–∞—Ç—É—Å" size="95px" top="65%" left="15%" delay="4s" color="#fb7185" onClick={() => setActiveTab('status')} />
                            <Bubble icon="fa-chart-line" label="–ó–¥–æ—Ä–æ–≤—å–µ" size="90px" top="60%" left="65%" delay="3s" color="#22c55e" onClick={() => setActiveTab('health')} />
                            <Bubble icon="fa-gear" label="–û–ø—Ü–∏–∏" size="85px" top="18%" left="65%" delay="1s" color="#94a3b8" onClick={() => {}} />
                        </div>
                    )}

                    {/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */}
                    {!isLoading && !error && activeTab && (
                        <div className="absolute inset-0 z-50 flex items-center justify-center p-4 bg-black/20 backdrop-blur-sm" onClick={() => setActiveTab(null)}>
                            <div className="glass-card" onClick={e => e.stopPropagation()}>
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-xl font-bold flex items-center gap-3">
                                        <i className={`fa-solid ${activeTab === 'calendar' ? 'fa-calendar text-sky-400' : activeTab === 'memory' ? 'fa-brain text-purple-400' : 'fa-heart-pulse text-rose-400'}`}></i>
                                        {activeTab === 'calendar' ? '–ë–ª–∏–∂–∞–π—à–∏–µ –ø–ª–∞–Ω—ã' : activeTab === 'memory' ? '–ü–∞–º—è—Ç—å –ö–∞—Ä–∏–Ω—ã' : '–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã'}
                                    </h2>
                                    <button onClick={() => setActiveTab(null)} className="w-8 h-8 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/20">
                                        <i className="fa-solid fa-times"></i>
                                    </button>
                                </div>

                                {activeTab === 'calendar' && (
                                    <div className="space-y-3 max-h-72 overflow-y-auto pr-2 scroll-hide">
                                        {events.length > 0 ? events.map((ev, i) => (
                                            <div key={i} className="bg-white/5 p-4 rounded-2xl border-l-4 border-sky-400 text-sm leading-relaxed">
                                                {ev}
                                            </div>
                                        )) : <p className="text-center text-slate-400 italic py-8">–ü–ª–∞–Ω–æ–≤ –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ...</p>}
                                    </div>
                                )}

                                {activeTab === 'memory' && (
                                    <div>
                                        <div className="flex gap-2 mb-4">
                                            <input 
                                                type="text" value={search} onChange={(e) => setSearch(e.target.value)}
                                                placeholder="–û —á–µ–º –≤—Å–ø–æ–º–Ω–∏—Ç—å?" 
                                                className="w-full bg-black/40 border border-white/10 rounded-2xl px-4 py-3 text-sm focus:outline-none focus:border-purple-500"
                                            />
                                            <button onClick={handleSearch} className="bg-purple-500 w-12 rounded-2xl flex items-center justify-center shadow-lg shadow-purple-500/20">
                                                <i className="fa-solid fa-search"></i>
                                            </button>
                                        </div>
                                        {memories && (
                                            <div className="bg-black/40 p-4 rounded-2xl text-xs text-slate-300 whitespace-pre-wrap max-h-48 overflow-y-auto border border-white/5">
                                                {memories}
                                            </div>
                                        )}
                                    </div>
                                )}

                                {activeTab === 'status' && (
                                    <div>
                                        <div className="grid grid-cols-2 gap-4 mb-4">
                                            <div className="bg-white/5 p-5 rounded-3xl text-center border border-white/5 shadow-inner">
                                                <p className="text-[10px] text-slate-400 uppercase font-black mb-2 tracking-widest">–ê—É—Ä–∞</p>
                                                <p className="text-4xl">{status.emoji || '‚ú®'}</p>
                                            </div>
                                            <div className={`bg-white/5 p-5 rounded-3xl text-center border border-white/5 shadow-inner`}>
                                                <p className="text-[10px] text-slate-400 uppercase font-black mb-2 tracking-widest">–ó–¥–æ—Ä–æ–≤—å–µ</p>
                                                <div className="flex flex-col items-center">
                                                    <span className={`w-3 h-3 rounded-full mb-1 ${status.health_confirmed ? 'bg-emerald-500' : 'bg-rose-500 animate-pulse'}`}></span>
                                                    <p className="text-sm font-bold uppercase tracking-tighter">{status.health_confirmed ? '–ù–æ—Ä–º–∞' : '–£–∫–æ–ª!'}</p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        {/* –¢–µ—Å—Ç —ç–º–æ—Ü–∏–π */}
                                        <div className="bg-white/5 p-4 rounded-2xl border border-white/5">
                                            <p className="text-[10px] text-slate-400 uppercase font-black mb-3 tracking-widest">üé≠ –¢–µ—Å—Ç —ç–º–æ—Ü–∏–π</p>
                                            <div className="grid grid-cols-3 gap-2">
                                                <button onClick={() => fetchEmotionTest('positive')} className="px-2 py-2 rounded-xl bg-green-500/20 border border-green-500 text-green-400 text-xs hover:bg-green-500/30">üòä –†–∞–¥–æ—Å—Ç—å</button>
                                                <button onClick={() => fetchEmotionTest('excited')} className="px-2 py-2 rounded-xl bg-yellow-500/20 border border-yellow-500 text-yellow-400 text-xs hover:bg-yellow-500/30">üî• –û–≥–æ–Ω—å</button>
                                                <button onClick={() => fetchEmotionTest('romantic')} className="px-2 py-2 rounded-xl bg-pink-500/20 border border-pink-500 text-pink-400 text-xs hover:bg-pink-500/30">üíï –†–æ–º–∞–Ω—Ç–∏–∫–∞</button>
                                                <button onClick={() => fetchEmotionTest('sad')} className="px-2 py-2 rounded-xl bg-blue-500/20 border border-blue-500 text-blue-400 text-xs hover:bg-blue-500/30">üò¢ –ì—Ä—É—Å—Ç—å</button>
                                                <button onClick={() => fetchEmotionTest('angry')} className="px-2 py-2 rounded-xl bg-red-500/20 border border-red-500 text-red-400 text-xs hover:bg-red-500/30">üò° –ó–ª–æ—Å—Ç—å</button>
                                                <button onClick={() => fetchEmotionTest('work')} className="px-2 py-2 rounded-xl bg-purple-500/20 border border-purple-500 text-purple-400 text-xs hover:bg-purple-500/30">üíº –†–∞–±–æ—Ç–∞</button>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {activeTab === 'health' && (
                                    <div>
                                        {healthStats ? (
                                            <div>
                                                {/* –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */}
                                                <div className="grid grid-cols-3 gap-3 mb-4">
                                                    <div className="bg-white/5 p-4 rounded-2xl text-center border border-emerald-500/30">
                                                        <p className="text-[9px] text-slate-400 uppercase font-black mb-1">–í—Å–µ–≥–æ</p>
                                                        <p className="text-2xl font-bold text-white">{healthStats.total_days}</p>
                                                        <p className="text-[9px] text-slate-500">–¥–Ω–µ–π</p>
                                                    </div>
                                                    <div className="bg-white/5 p-4 rounded-2xl text-center border border-emerald-500/30">
                                                        <p className="text-[9px] text-slate-400 uppercase font-black mb-1">–£—Å–ø–µ—Ö</p>
                                                        <p className="text-2xl font-bold text-emerald-400">{healthStats.confirmed_days}</p>
                                                        <p className="text-[9px] text-slate-500">–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π</p>
                                                    </div>
                                                    <div className="bg-white/5 p-4 rounded-2xl text-center border border-emerald-500/30">
                                                        <p className="text-[9px] text-slate-400 uppercase font-black mb-1">%</p>
                                                        <p className={`text-2xl font-bold ${healthStats.success_rate >= 80 ? 'text-emerald-400' : healthStats.success_rate >= 50 ? 'text-yellow-400' : 'text-red-400'}`}>{healthStats.success_rate}%</p>
                                                        <p className="text-[9px] text-slate-500">—É—Å–ø–µ—à–Ω–æ—Å—Ç—å</p>
                                                    </div>
                                                </div>

                                                {/* –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä */}
                                                <div className="mb-4">
                                                    <div className="flex justify-between text-xs mb-2">
                                                        <span className="text-slate-400">–ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞ 7 –¥–Ω–µ–π</span>
                                                        <span className="text-emerald-400 font-bold">{healthStats.success_rate}%</span>
                                                    </div>
                                                    <div className="w-full h-3 bg-white/10 rounded-full overflow-hidden">
                                                        <div className="h-full bg-gradient-to-r from-emerald-500 to-green-400 transition-all duration-500" style={{ width: `${healthStats.success_rate}%` }}></div>
                                                    </div>
                                                </div>

                                                {/* –ò—Å—Ç–æ—Ä–∏—è */}
                                                <div className="space-y-2 max-h-48 overflow-y-auto pr-2 scroll-hide">
                                                    <p className="text-[10px] text-slate-400 uppercase font-black mb-2">–ò—Å—Ç–æ—Ä–∏—è</p>
                                                    {healthStats.daily_stats && healthStats.daily_stats.length > 0 ? (
                                                        healthStats.daily_stats.slice(0, 7).map((day, i) => (
                                                            <div key={i} className="flex items-center justify-between bg-white/5 p-3 rounded-xl border-l-4 border-emerald-500">
                                                                <div className="flex items-center gap-3">
                                                                    <span className={`w-2 h-2 rounded-full ${day.confirmed ? 'bg-emerald-500' : 'bg-red-500'}`}></span>
                                                                    <span className="text-sm text-slate-300">{day.date}</span>
                                                                </div>
                                                                <span className="text-xs text-slate-400">{day.time || 'N/A'}</span>
                                                            </div>
                                                        ))
                                                    ) : (
                                                        <p className="text-center text-slate-400 italic py-4 text-sm">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∑–∞ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥</p>
                                                    )}
                                                </div>
                                            </div>
                                        ) : (
                                            <div className="flex items-center justify-center h-48">
                                                <button onClick={fetchHealthStats} className="bg-emerald-500 px-6 py-3 rounded-2xl font-bold hover:bg-emerald-600 transition">
                                                    –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                                                </button>
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
