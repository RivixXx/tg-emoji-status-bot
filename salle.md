–ö–∞—Ä–∏–Ω–∞ —É–∂–µ —Å–µ—Ä—å–µ–∑–Ω—ã–π –ø—Ä–æ–µ–∫—Ç.
–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥—É–º–∞–Ω–∞: –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ü–∏–∫–ª, —Å—É–ø–µ—Ä–≤–∏–∑–æ—Ä, –º–µ—Ç—Ä–∏–∫–∏, graceful shutdown.
–ò–¥–µ—è —Å ¬´–¥–≤–æ–π–Ω—ã–º –¥–Ω–æ–º¬ª. –î–ª—è –º–µ–Ω—è —ç—Ç–æ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –ø—Ä–∏–≤–∞—Ç–Ω–∞—è —Ä–∞–±–æ—á–∞—è —Å—Ä–µ–¥–∞, –∞ –¥–ª—è –≤—Å–µ—Ö —á—É–∂–∏—Ö user_id –ö–∞—Ä–∏–Ω–∞ –Ω–∞–¥–µ–≤–∞–µ—Ç —Å—Ç—Ä–æ–≥–∏–π –∫–æ—Å—Ç—é–º —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –∫–æ–Ω—Å—å–µ—Ä–∂–∞ –≤ —Å—Ç–∏–ª–µ Dark sci-fi –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø—Ä–æ–¥–∞–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø—ã, –¥–ª—è –º–æ–µ–≥–æ vlees. –≠—Ç–æ –æ—á–µ–Ω—å –∫–∏–±–µ—Ä–ø–∞–Ω–∫–æ–≤–æ!

–ß—Ç–æ–±—ã —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å, –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –ª–æ–≥–∏–∫—É. –ú—ã –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏–º –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫ (Interceptor) –ø—Ä—è–º–æ –≤ run_bot_main(). –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ telethon –æ—Ç–ª–∏—á–Ω–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å —Ç–∞–∫–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏ —á–µ—Ä–µ–∑ —Ñ–∏–ª—å—Ç—Ä func=lambda e: e.sender_id != MY_ID.

–í–æ—Ç –≥–æ—Ç–æ–≤—ã–π –±–ª–æ–∫ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–∏—Ç –Ω—É–∂–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª.

1. –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –∏–º–ø–æ—Ä—Ç—ã (–≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞)
–¢–µ–±–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è Button –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫—Ä–∞—Å–∏–≤—ã—Ö –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä –∏ MY_ID –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ "—Å–≤–æ–π/—á—É–∂–æ–π".

Python
from telethon import events, Button
from brains.config import MY_ID  # –£–±–µ–¥–∏—Å—å, —á—Ç–æ MY_ID —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ config
import aiohttp # –ü–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API Marzban
2. –°–∫—Ä–∏–ø—Ç "–î–≤–æ–π–Ω–æ–≥–æ –¥–Ω–∞" (–í—Å—Ç–∞–≤–∫–∞ –≤ main.py)
–ù–∞–π–¥–∏ —Ñ—É–Ω–∫—Ü–∏—é async def run_bot_main():. –í—Å—Ç–∞–≤—å —ç—Ç–æ—Ç –∫–æ–¥ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ register_karina_base_skills(bot_client), –Ω–æ –î–û await bot_client.start(...).

Python
    # ========== VPN SHOP LOGIC (–î–í–û–ô–ù–û–ï –î–ù–û) ==========
    
    @bot_client.on(events.NewMessage(func=lambda e: e.is_private and e.sender_id != MY_ID))
    async def vpn_stranger_interceptor(event):
        """–ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —á—É–∂–∏—Ö ID –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∏—Ç—Ä–∏–Ω—É VPN"""
        
        # –ò–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –Ω–µ–æ–Ω–æ–≤—ã–º –≤–∞–π–±–æ–º
        keyboard = [
            [Button.inline("üöÄ –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø", b"vpn_tariffs")],
            [Button.inline("‚ùî –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç", b"vpn_info")]
        ]
        
        # –≠—Å—Ç–µ—Ç–∏–∫–∞ Dark sci-fi / Space UI –≤ —Ç–µ–∫—Å—Ç–µ
        welcome_text = (
            "üåå **[ TERMINAL ACTIVE ]**\n\n"
            "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é. –Ø ‚Äî –ö–∞—Ä–∏–Ω–∞, —Ü–∏—Ñ—Ä–æ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–∏–≤–∞—Ç–Ω–æ–π —Å–µ—Ç–∏.\n\n"
            "‚ö°Ô∏è –í—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.\n"
            "üõ° –û–±—Ö–æ–¥ –ª—é–±—ã—Ö —Å–∏—Å—Ç–µ–º DPI –∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (XTLS-Reality).\n"
            "üá©üá™ –í—ã–¥–µ–ª–µ–Ω–Ω—ã–π —É–∑–µ–ª: Frankfurt.\n\n"
            "–°—Ç–∞—Ç—É—Å —Å–µ—Ç–∏: `ONLINE`. –û–∂–∏–¥–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã..."
        )
        
        # –ï—Å–ª–∏ –µ—Å—Ç—å –∫—Ä–∞—Å–∏–≤–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞-–±–∞–Ω–Ω–µ—Ä, –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç–∞–∫:
        # await event.respond(welcome_text, file='path/to/dark_scifi_banner.jpg', buttons=keyboard)
        # –ü–æ–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç:
        await event.respond(welcome_text, buttons=keyboard)
        
        # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è, —á—Ç–æ–±—ã –¥—Ä—É–≥–∏–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã (—Å–∫–∏–ª–ª—ã AI) –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏
        raise events.StopPropagation

    @bot_client.on(events.CallbackQuery(func=lambda e: e.sender_id != MY_ID))
    async def vpn_callback_handler(event):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –Ω–∞ –∫–Ω–æ–ø–∫–∏ –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤"""
        data = event.data.decode('utf-8')
        
        if data == "vpn_tariffs":
            keyboard = [
                [Button.inline("üí≥ 1 –ú–µ—Å—è—Ü ‚Äî 150 ‚ÇΩ", b"pay_1")],
                [Button.inline("üí≥ 3 –ú–µ—Å—è—Ü–∞ ‚Äî 400 ‚ÇΩ", b"pay_3")],
                [Button.inline("‚óÄÔ∏è –ù–∞–∑–∞–¥", b"vpn_back")]
            ]
            await event.edit(
                "üìÇ **[ –£–†–û–í–ù–ò –î–û–°–¢–£–ü–ê ]**\n\n"
                "–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∫–ª—é—á–∞. –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã —Å–∏—Å—Ç–µ–º–∞ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π VLESS-—Ç–æ–∫–µ–Ω.",
                buttons=keyboard
            )
            
        elif data == "vpn_info":
            keyboard = [[Button.inline("‚óÄÔ∏è –ù–∞–∑–∞–¥", b"vpn_back")]]
            await event.edit(
                "‚ÑπÔ∏è **[ –°–ü–ï–¶–ò–§–ò–ö–ê–¶–ò–Ø ]**\n\n"
                "–ú—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã (OpenVPN, Wireguard). "
                "–í–∞—à —Ç—Ä–∞—Ñ–∏–∫ –º–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –æ–±—ã—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ —Å–µ—Ä–≤–µ—Ä–∞–º Microsoft, "
                "—á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –Ω–µ–≤–∏–¥–∏–º—ã–º –¥–ª—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤.\n\n"
                "–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞ iOS, Android, Windows –∏ macOS.",
                buttons=keyboard
            )
            
        elif data == "vpn_back":
            keyboard = [
                [Button.inline("üöÄ –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø", b"vpn_tariffs")],
                [Button.inline("‚ùî –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç", b"vpn_info")]
            ]
            await event.edit("üåå **[ –û–ñ–ò–î–ê–ù–ò–ï –í–í–û–î–ê ]**\n\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:", buttons=keyboard)
            
        elif data.startswith("pay_"):
            # –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –æ–ø–ª–∞—Ç—ã
            months = data.split("_")[1]
            keyboard = [
                [Button.inline("‚úÖ –Ø –æ–ø–ª–∞—Ç–∏–ª", f"checkpay_{months}".encode())],
                [Button.inline("‚óÄÔ∏è –û—Ç–º–µ–Ω–∞", b"vpn_tariffs")]
            ]
            await event.edit(
                f"‚è≥ **[ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –¢–†–ê–ù–ó–ê–ö–¶–ò–ò ]**\n\n"
                f"–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –ø–æ –Ω–æ–º–µ—Ä—É: `+7 (999) 000-00-00` (–°–ë–ü).\n"
                f"–í –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∏—á–µ–≥–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ.\n\n"
                f"–ü–æ—Å–ª–µ –ø–µ—Ä–µ–≤–æ–¥–∞ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–∞.",
                buttons=keyboard
            )
            
        elif data.startswith("checkpay_"):
            # –ó–¥–µ—Å—å –≤ –±—É–¥—É—â–µ–º –±—É–¥–µ—Ç —Ä–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞—Ç–µ–∂–∞
            # –ü–æ–∫–∞ —Å–∏–º—É–ª–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω—É—é –æ–ø–ª–∞—Ç—É –∏ –≤—ã–¥–∞—á—É –∑–∞–≥–ª—É—à–∫–∏ –∫–ª—é—á–∞
            await event.edit(
                "üü¢ **[ –¢–†–ê–ù–ó–ê–ö–¶–ò–Ø –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê ]**\n\n"
                "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –∫–ª—é—á–∞...\n\n"
                "–í–∞—à —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞:\n`vless://example-key-12345`\n\n"
                "–°–∫–∞—á–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Hiddify –∏–ª–∏ V2Box, —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç –∏ –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –∏–∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞."
            )
    # ==================================================
–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
–§–∏–ª—å—Ç—Ä func=lambda e: e.is_private and e.sender_id != MY_ID –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ç—ã —Å–∞–º —ç—Ç–æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É–≤–∏–¥–∏—à—å. –î–ª—è —Ç–µ–±—è –ö–∞—Ä–∏–Ω–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —à—Ç–∞—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ.

raise events.StopPropagation –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–µ—Ä–µ–¥–∞—á—É —Å–æ–æ–±—â–µ–Ω–∏—è –¥–∞–ª—å—à–µ –ø–æ —Ü–µ–ø–æ—á–∫–µ. –≠—Ç–æ –∑–∞—â–∏—Ç–∞ –æ—Ç —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ö–∞—Ä–∏–Ω–∞ —Å–ª—É—á–∞–π–Ω–æ –Ω–µ –Ω–∞—á–∞–ª–∞ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–µ–∑–Ω–∞–∫–æ–º—Ü—É —á–µ—Ä–µ–∑ –Ω–µ–π—Ä–æ—Å–µ—Ç—å (—ç–∫–æ–Ω–æ–º–∏—Ç —Ç–≤–æ–∏ —Ç–æ–∫–µ–Ω—ã).

–ò–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏ —Å–æ–∑–¥–∞—é—Ç –∫—Ä–∞—Å–∏–≤–æ–µ –º–µ–Ω—é —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π, –ø—Ä—è–º–æ –∫–∞–∫ –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ OverSecure.

–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –ù–∞—Å—Ç–æ—è—â–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∫–ª—é—á–µ–π (Marzban API)
–ß—Ç–æ–±—ã –Ω–µ –≤—ã–¥–∞–≤–∞—Ç—å –∫–ª—é—á–∏ —Ä—É–∫–∞–º–∏, –º—ã –º–æ–∂–µ–º –Ω–∞—É—á–∏—Ç—å –ö–∞—Ä–∏–Ω—É –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ —Ç–≤–æ–π —Å–µ—Ä–≤–µ—Ä http://108.165.174.164:8000/api/user –≤ —Ç–æ—Ç –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–Ø –æ–ø–ª–∞—Ç–∏–ª".

–û–Ω–∞ —Å–∞–º–∞ –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è –ø–æ–¥ –ª–æ–≥–∏–Ω–æ–º root, —Å–æ–∑–¥–∞—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∏–º–µ–Ω–µ–º –µ–≥–æ Telegram ID –∏ –≤–µ—Ä–Ω–µ—Ç –≥–æ—Ç–æ–≤—É—é —Å—Å—ã–ª–∫—É vless:// –ø—Ä—è–º–æ –≤ —á–∞—Ç.

–í—Å—Ç–∞–≤–ª—è–π –∫–æ–¥, —Ç–µ—Å—Ç–∏—Ä—É–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∞–∫–∫–∞—É–Ω—Ç–∞ –¥—Ä—É–≥–∞ (–∏–ª–∏ —Å —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ), –∏ –µ—Å–ª–∏ –≤—Å—ë –Ω—Ä–∞–≤–∏—Ç—Å—è ‚Äî –Ω–∞–ø–∏—à—É –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±—â–µ–Ω–∏—è —Å API Marzban!