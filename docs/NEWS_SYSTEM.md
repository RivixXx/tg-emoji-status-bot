# üì∞ –£–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–æ–≤–æ—Å—Ç–µ–π

## üìã –û–±–∑–æ—Ä

–û–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–æ–≤–æ—Å—Ç–µ–π —Å **–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–≥–æ** –∏ **–∑–∞—â–∏—Ç–æ–π –æ—Ç –¥—É–±–ª–µ–π**.

---

## ‚ú® –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –ë—ã–ª–æ ‚ùå
- –ù–æ–≤–æ—Å—Ç–∏ –≤—Å–µ–≥–¥–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–∂–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ
- –ò—Å—Ç–æ—á–Ω–∏–∫–∏ —Å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏ URL
- –ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏

### –°—Ç–∞–ª–æ ‚úÖ
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –≤ –ë–î
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ URL (–Ω–∏–∫–∞–∫–∏—Ö –¥—É–±–ª–µ–π)
- –ü–æ–∫–∞–∑ —Ç–æ–ª—å–∫–æ **–Ω–æ–≤—ã—Ö** –Ω–æ–≤–æ—Å—Ç–µ–π
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 1 —á–∞—Å
- 4 –∏—Å—Ç–æ—á–Ω–∏–∫–∞ RSS
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `news_history`

```sql
CREATE TABLE news_history (
    id BIGSERIAL PRIMARY KEY,
    title TEXT NOT NULL,        -- –ó–∞–≥–æ–ª–æ–≤–æ–∫
    link TEXT UNIQUE NOT NULL,  -- URL (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
    source TEXT NOT NULL,       -- –ò—Å—Ç–æ—á–Ω–∏–∫
    category TEXT,              -- –ö–∞—Ç–µ–≥–æ—Ä–∏—è
    published_at TIMESTAMPTZ,   -- –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
    shown_at TIMESTAMPTZ,       -- –ö–æ–≥–¥–∞ –ø–æ–∫–∞–∑–∞–ª–∏
    user_id BIGINT DEFAULT 0    -- ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
);
```

### –ò–Ω–¥–µ–∫—Å—ã

```sql
idx_news_shown_at    -- –î–ª—è –±—ã—Å—Ç—Ä–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –¥–∞—Ç–µ
idx_news_category    -- –î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
idx_news_user        -- –î–ª—è –º—É–ª—å—Ç–∏–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞
idx_news_link        -- –î–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –¥—É–±–ª–µ–π
```

---

## üì± –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### `/news` ‚Äî –°–≤–µ–∂–∏–µ –Ω–æ–≤–æ—Å—Ç–∏

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏–∑ —Ç–µ–ª–µ–º–∞—Ç–∏–∫–∏ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞.

**–ü—Ä–∏–º–µ—Ä—ã:**
```
/news                ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–µ –Ω–æ–≤–æ—Å—Ç–∏
/news force          ‚Üí –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å
/news fresh          ‚Üí –¢–æ –∂–µ —Å–∞–º–æ–µ
/news –æ–±–Ω–æ–≤–∏—Ç—å       ‚Üí –¢–æ –∂–µ —Å–∞–º–æ–µ (–ø–æ-—Ä—É—Å—Å–∫–∏)
```

**–û—Ç–≤–µ—Ç –µ—Å–ª–∏ –Ω–æ–≤–æ—Å—Ç–µ–π –Ω–µ—Ç:**
```
üì∞ –ù–æ–≤—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –∑–∞ —Å–µ–≥–æ–¥–Ω—è –Ω–µ—Ç. –í—Å—ë –≤–∞–∂–Ω–æ–µ —è —É–∂–µ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–ª–∞! üòä
```

---

### `/newsforce` ‚Äî –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–û—á–∏—â–∞–µ—Ç –∫—ç—à –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```
/newsforce
```

---

### `/newssources` ‚Äî –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∫–ª—é—á–∞—Ç—å/–æ—Ç–∫–ª—é—á–∞—Ç—å –∏—Ö.

**–ü—Ä–∏–º–µ—Ä—ã:**
```
/newssources                    ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
/newssources enable Habr        ‚Üí –í–∫–ª—é—á–∏—Ç—å Habr Transport
/newssources disable –í–µ—Å—Ç–Ω–∏–∫    ‚Üí –û—Ç–∫–ª—é—á–∏—Ç—å –í–µ—Å—Ç–Ω–∏–∫ –ì–õ–û–ù–ê–°–°
```

**–í—ã–≤–æ–¥:**
```
üì∞ –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π:

‚úÖ Habr Transport (innovations)
   https://habr.com/ru/rss/hubs/transport/articles/all/?fl=ru

‚úÖ –í–µ—Å—Ç–Ω–∏–∫ –ì–õ–û–ù–ê–°–° (telematics)
   http://vestnik-glonass.ru/rss/

‚è∏Ô∏è –†–æ—Å–∞–≤—Ç–æ—Ç—Ä–∞–Ω—Å (tachography)
   http://rosavtotrans.ru/ru/news/rss/

‚úÖ TransportRussia (logistics)
   https://www.transrussia.org/rss/news
```

---

### `/newsclear [days]` ‚Äî –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏

–£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏.

**–ü—Ä–∏–º–µ—Ä—ã:**
```
/newsclear         ‚Üí –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
/newsclear 7       ‚Üí –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π
/newsclear 90      ‚Üí –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—à–µ 3 –º–µ—Å—è—Ü–µ–≤
```

---

## üîß –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π

### –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é (4 –∏—Å—Ç–æ—á–Ω–∏–∫–∞)

| –ù–∞–∑–≤–∞–Ω–∏–µ | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | URL |
|----------|-----------|-----|
| **Habr Transport** | innovations | `https://habr.com/ru/rss/hubs/transport/articles/all/?fl=ru` |
| **–í–µ—Å—Ç–Ω–∏–∫ –ì–õ–û–ù–ê–°–°** | telematics | `http://vestnik-glonass.ru/rss/` |
| **–†–æ—Å–∞–≤—Ç–æ—Ç—Ä–∞–Ω—Å** | tachography | `http://rosavtotrans.ru/ru/news/rss/` |
| **TransportRussia** | logistics | `https://www.transrussia.org/rss/news` |

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏

- `telematics` ‚Äî –¢–µ–ª–µ–º–∞—Ç–∏–∫–∞ –∏ –ì–õ–û–ù–ê–°–°
- `tachography` ‚Äî –¢–∞—Ö–æ–≥—Ä–∞—Ñ–∏—è –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å
- `innovations` ‚Äî –ò–Ω–Ω–æ–≤–∞—Ü–∏–∏
- `logistics` ‚Äî –õ–æ–≥–∏—Å—Ç–∏–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞

```python
from brains.news import add_custom_source

await add_custom_source(
    name="–ú–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫",
    url="https://example.com/rss",
    category="telematics"
)
```

---

## üß† –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π

```
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞ (1 —á–∞—Å)
   ‚îÇ
   ‚îú‚îÄ –ï—Å—Ç—å –≤ –∫—ç—à–µ ‚Üí –í–µ—Ä–Ω—É—Ç—å –∏–∑ –∫—ç—à–∞
   ‚îî‚îÄ –ù–µ—Ç –≤ –∫—ç—à–µ ‚Üí –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
        ‚îÇ
2. –ü–æ–ª—É—á–∏—Ç—å URL –∏–∑ –ë–î (–ø–æ–∫–∞–∑–∞–Ω–Ω—ã–µ)
   ‚îÇ
3. –°–ø–∞—Ä—Å–∏—Ç—å RSS –∏—Å—Ç–æ—á–Ω–∏–∫–∏
   ‚îÇ
4. –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –¥—É–±–ª–∏
   ‚îÇ  ‚îú‚îÄ –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –µ—Å–ª–∏ URL –≤ –ë–î
   ‚îÇ  ‚îî‚îÄ –î–æ–±–∞–≤–∏—Ç—å –≤ –≤—ã–±–æ—Ä–∫—É
   ‚îÇ
5. –ï—Å–ª–∏ –Ω–æ–≤–æ—Å—Ç–µ–π –Ω–µ—Ç ‚Üí "–ù–æ–≤–æ—Å—Ç–µ–π –Ω–µ—Ç"
   ‚îÇ
6. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—ã–µ URL –≤ –ë–î
   ‚îÇ
7. –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å
   ‚îÇ
8. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫—ç—à –Ω–∞ 1 —á–∞—Å
```

### –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞

```
üì∞ –ù–∞–π–¥–µ–Ω–æ 87 —É–∂–µ –ø–æ–∫–∞–∑–∞–Ω–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π
üì∞ –í—Å–µ–≥–æ —Å–æ–±—Ä–∞–Ω–æ –Ω–æ–≤–æ—Å—Ç–µ–π: 42
üì∞ –ù–æ–≤—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏: 5
üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ 5 –Ω–æ–≤–æ—Å—Ç–µ–π –≤ –∏—Å—Ç–æ—Ä–∏—é
```

---

## üìä –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞

```
üóû **–°–≤–µ–∂–µ–µ –≤ —Ç–µ–ª–µ–º–∞—Ç–∏–∫–µ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–µ:**

*üõ∞ –¢–µ–ª–µ–º–∞—Ç–∏–∫–∞ –∏ –ì–õ–û–ù–ê–°–°*
üîπ –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è –∞–≤—Ç–æ–ø–∞—Ä–∫–æ–≤
üîó https://example.com/news/123

*üìä –¢–∞—Ö–æ–≥—Ä–∞—Ñ–∏—è –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å*
üîπ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–µ –æ —Ç–∞—Ö–æ–≥—Ä–∞—Ñ–∞—Ö
üîó https://example.com/news/456

üìÖ **–ë–ª–∏–∂–∞–π—à–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è 2026:**
üìç 24-25.03.2026 ‚Äî –ò–¢–° —Ä–µ–≥–∏–æ–Ω–∞–º 2026 (–¢—É–ª–∞)

_–•–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ? –ü—Ä–æ—Å—Ç–æ —Å–ø—Ä–æ—Å–∏!_
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –ó–∞–≥–æ–ª–æ–≤–∫–∏ >100 —Å–∏–º–≤–æ–ª–æ–≤ —Å–æ–∫—Ä–∞—â–∞—é—Ç—Å—è
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- –ú–∞–∫—Å–∏–º—É–º 2 –Ω–æ–≤–æ—Å—Ç–∏ –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—é
- –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –≤—Å–µ–≥–¥–∞ –≤ –∫–æ–Ω—Ü–µ

---

## üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–µ–π

### –ü–æ URL

```python
# –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–æ–≤–æ—Å—Ç–∏
link = "https://example.com/news/123"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º
if link not in shown_links:
    # –≠—Ç–æ –Ω–æ–≤–∞—è –Ω–æ–≤–æ—Å—Ç—å
    ...
```

### –ü–æ —Ö—ç—à—É –∑–∞–≥–æ–ª–æ–≤–∫–∞ (—Ä–µ–∑–µ—Ä–≤)

```python
import hashlib

# –ï—Å–ª–∏ URL –º–µ–Ω—è—é—Ç—Å—è (—Ä–µ–¥–∫–æ)
news_hash = hashlib.md5(title.encode()).hexdigest()

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Ö—ç—à—É
if news_hash not in shown_hashes:
    # –≠—Ç–æ –Ω–æ–≤–∞—è –Ω–æ–≤–æ—Å—Ç—å
    ...
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î

```sql
-- –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤ Supabase SQL Editor
-- –ò–∑ —Ñ–∞–π–ª–∞ docs/init_news_history.sql
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

```python
from brains.news import get_latest_news

# –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (–¥–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤–æ—Å—Ç–∏)
news1 = await get_latest_news()
print(news1)

# –í—Ç–æ—Ä–æ–π –∑–∞–ø—É—Å–∫ (–¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å "–Ω–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π")
news2 = await get_latest_news()
print(news2)

# –° —Ñ–æ—Ä—Å–∏—Ä–æ–≤–∞–Ω–∏–µ–º (–æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞)
news3 = await get_latest_news(force_refresh=True)
print(news3)
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î

```sql
-- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏
SELECT title, source, shown_at 
FROM news_history 
ORDER BY shown_at DESC 
LIMIT 10;

-- –ü–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
SELECT COUNT(*) FROM news_history;
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### –ò–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–§–∞–π–ª:** `brains/news.py`

```python
# –ë—ã–ª–æ: –∫—ç—à –Ω–∞ 1 —á–∞—Å
NEWS_CACHE["expire_at"] = now + timedelta(hours=1)

# –°—Ç–∞–ª–æ: –∫—ç—à –Ω–∞ 30 –º–∏–Ω—É—Ç
NEWS_CACHE["expire_at"] = now + timedelta(minutes=30)
```

### –ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤–æ—Å—Ç–µ–π

```python
# –ë—ã–ª–æ: 5 –Ω–æ–≤–æ—Å—Ç–µ–π
news = await get_latest_news(limit=5, ...)

# –°—Ç–∞–ª–æ: 10 –Ω–æ–≤–æ—Å—Ç–µ–π
news = await get_latest_news(limit=10, ...)
```

### –ò–∑–º–µ–Ω–∏—Ç—å –ø–µ—Ä–∏–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è

```python
# –ë—ã–ª–æ: —Ö—Ä–∞–Ω–∏—Ç—å 30 –¥–Ω–µ–π
count = await clear_old_news_history(days=30)

# –°—Ç–∞–ª–æ: —Ö—Ä–∞–Ω–∏—Ç—å 7 –¥–Ω–µ–π
count = await clear_old_news_history(days=7)
```

---

## üìö API –º–æ–¥—É–ª—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `get_latest_news(limit, force_refresh, user_id)` | –ü–æ–ª—É—á–∏—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ |
| `get_shown_news_links(limit)` | –ü–æ–ª—É—á–∏—Ç—å –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–µ URL |
| `save_news_to_history(news_items, user_id)` | –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏—é |
| `clear_old_news_history(days)` | –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä–æ–µ |
| `clear_news_cache()` | –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à |

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `get_news_sources()` | –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ |
| `enable_source(name)` | –í–∫–ª—é—á–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ |
| `disable_source(name)` | –û—Ç–∫–ª—é—á–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ |
| `add_custom_source(name, url, category)` | –î–æ–±–∞–≤–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ |

---

## üîç Troubleshooting

### "–ù–æ–≤–æ—Å—Ç–µ–π –Ω–µ—Ç" –ø–æ—Å—Ç–æ—è–Ω–Ω–æ

**–ü—Ä–∏—á–∏–Ω–∞:** –í—Å–µ URL —É–∂–µ –≤ –ë–î

**–†–µ—à–µ–Ω–∏–µ:**
```bash
/newsclear 1      # –û—á–∏—Å—Ç–∏—Ç—å –≤—á–µ—Ä–∞—à–Ω–∏–µ
/newsforce        # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å
```

### "–ò—Å—Ç–æ—á–Ω–∏–∫ –≤–µ—Ä–Ω—É–ª 404"

**–ü—Ä–∏—á–∏–Ω–∞:** URL –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ —Å–º–µ–Ω–∏–ª—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
/newssources disable <–∏–º—è>     # –û—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–π
# –ò–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π URL
```

### –ö—ç—à –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –≤ –∫–æ–¥–µ
from brains.news import NEWS_CACHE
NEWS_CACHE["news"] = None
NEWS_CACHE["expire_at"] = None
```

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏

### –ü–æ–ª–µ–∑–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

```sql
-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤–æ—Å—Ç–µ–π –∑–∞ –Ω–µ–¥–µ–ª—é
SELECT DATE(shown_at) as date, COUNT(*) 
FROM news_history 
WHERE shown_at > NOW() - INTERVAL '7 days'
GROUP BY DATE(shown_at)
ORDER BY date DESC;

-- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
SELECT source, COUNT(*) as count
FROM news_history
GROUP BY source
ORDER BY count DESC;

-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞ –º–µ—Å—è—Ü
SELECT category, COUNT(*) as count
FROM news_history
WHERE shown_at > NOW() - INTERVAL '30 days'
GROUP BY category;
```

---

## üìù –§–∞–π–ª—ã

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `brains/news.py` | –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –Ω–æ–≤–æ—Å—Ç–µ–π |
| `docs/init.sql` | –¢–∞–±–ª–∏—Ü–∞ `news_history` |
| `docs/init_news_history.sql` | –ú–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –ë–î |
| `skills/__init__.py` | –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ |
| `main.py` | –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ |

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –§–µ–≤—Ä–∞–ª—å 2026
